"use strict";(self["webpackChunkweweb_front"]=self["webpackChunkweweb_front"]||[]).push([[692],{8692:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var i=a(6252),s=a(9963);const n={class:"flex flex-col"},l=(0,i._)("a",{class:"ml-2 ww-editor-link",href:"https://docs.xano.com/developer-api",target:"_blank"}," Find it here ",-1),o={class:"flex items-center"},p=(0,i._)("a",{class:"ml-2 ww-editor-link",href:"https://docs.xano.com/metadata-api",target:"_blank"}," Find it here ",-1),d={class:"flex items-center"},r={key:1,class:"label-sm flex items-center text-yellow-500 mb-3"},c={key:2,class:"label-sm flex items-center text-red-500 mb-3"};function u(e,t,a,u,m,h){const g=(0,i.up)("wwEditorInputText"),y=(0,i.up)("wwEditorIcon"),w=(0,i.up)("wwEditorFormRow"),b=(0,i.up)("wwEditorInputRow"),D=(0,i.up)("wwLoader");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",n,[m.deprecated?((0,i.wg)(),(0,i.j4)(w,{key:0,required:"",label:"Developer API key (Deprecated)"},{"append-label":(0,i.w5)((()=>[l])),default:(0,i.w5)((()=>[(0,i._)("div",o,[(0,i.Wm)(g,{type:m.isKeyVisible?"text":"password",name:"api-key",placeholder:"ey**************","model-value":a.settings.privateData.apiKey,"onUpdate:modelValue":h.changeApiKey,class:"w-full mr-2",disabled:a.settings.privateData.metaApiKey},null,8,["type","model-value","onUpdate:modelValue","disabled"]),(0,i._)("button",{class:"ww-editor-button -icon -secondary -dark",onClick:t[0]||(t[0]=(0,s.iM)((e=>m.isKeyVisible=!m.isKeyVisible),["prevent"]))},[(0,i.Wm)(y,{name:m.isKeyVisible?"eye-off":"eye"},null,8,["name"])])])])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(w,{required:"",label:"Metadata API Key"},{"append-label":(0,i.w5)((()=>[p])),default:(0,i.w5)((()=>[(0,i._)("div",d,[(0,i.Wm)(g,{type:m.isKeyVisible?"text":"password",name:"meta-api-key",placeholder:"ey**************","model-value":a.settings.privateData.metaApiKey,"onUpdate:modelValue":h.changeMetaApiKey,class:"w-full mr-2"},null,8,["type","model-value","onUpdate:modelValue"]),(0,i._)("button",{class:"ww-editor-button -icon -secondary -dark",onClick:t[1]||(t[1]=(0,s.iM)((e=>m.isKeyVisible=!m.isKeyVisible),["prevent"]))},[(0,i.Wm)(y,{name:m.isKeyVisible?"eye-off":"eye"},null,8,["name"])])])])),_:1}),m.deprecated?((0,i.wg)(),(0,i.iD)("p",r,[(0,i.Wm)(y,{class:"mr-1",name:"warning",small:""}),(0,i.Uk)(" Setting up your Metadata API key will reset your configuration for this step. ")])):(0,i.kq)("",!0),(0,i.Wm)(b,{type:"select",placeholder:"Select an instance","model-value":a.settings.privateData.instanceId,disabled:!a.settings.privateData.apiKey&&!a.settings.privateData.metaApiKey,options:h.instancesOptions,required:"",label:"Instance","onUpdate:modelValue":h.changeInstance},null,8,["model-value","disabled","options","onUpdate:modelValue"]),(0,i.Wm)(b,{type:"query",placeholder:"Default: "+(m.defaultDomain||""),"model-value":a.settings.publicData.customDomain,disabled:!a.settings.privateData.instanceId,label:"Instance domain","onUpdate:modelValue":h.setCustomDomain},null,8,["placeholder","model-value","disabled","onUpdate:modelValue"]),h.incorrectCustomDomain?((0,i.wg)(),(0,i.iD)("p",c,[(0,i.Wm)(y,{class:"mr-1",name:"warning",small:""}),(0,i.Uk)(" The custom domain must not include the protocol (http(s)://) ")])):(0,i.kq)("",!0),(0,i.Wm)(b,{label:"Workspace",type:"select",placeholder:"Select a workspace","model-value":a.settings.privateData.workspaceId,disabled:!a.settings.privateData.instanceId,options:h.workspacesOptions,"onUpdate:modelValue":h.changeWorkspace},null,8,["model-value","disabled","options","onUpdate:modelValue"])]),(0,i.Wm)(D,{loading:m.isLoading},null,8,["loading"])],64)}let m=null;var h={props:{plugin:{type:Object,required:!0},settings:{type:Object,required:!0}},emits:["update:settings"],data(){return{deprecated:!1,useMetaApi:!1,isKeyVisible:!1,isLoading:!1,instances:[],workspaces:[],defaultDomain:null}},computed:{instancesOptions(){return this.instances.map((e=>({label:e.name,value:String(e.id)})))},workspacesOptions(){return[{label:"None",value:null},...this.workspaces.map((e=>({label:e.name,value:e.id,...e})))]},incorrectCustomDomain(){return(this.settings.publicData.customDomain||"").includes("http")}},watch:{async"settings.privateData.metaApiKey"(e){this.isLoading=!0;try{this.useMetaApi?(await m.changeApiKey(e),this.sync()):(await this.initManager(),this.useMetaApi=!0)}catch(t){wwLib.wwNotification.open({text:"Failed to use the new API key, please ensure your API key has the permission required.",color:"red"})}this.isLoading=!1}},async mounted(){this.deprecated=!!this.settings.privateData.apiKey,this.useMetaApi=!!this.settings.privateData.metaApiKey,this.initManager()},methods:{async initManager(){this.isLoading=!0,m=this.plugin.createManager(this.settings);try{await m.init(),this.sync()}catch(e){wwLib.wwNotification.open({text:"Failed to init Xano, please ensure your API key has the permission required.",color:"red"})}this.isLoading=!1},sync(){this.instances=m.getInstances(),this.workspaces=m.getWorkspaces(),this.defaultDomain=m.getBaseDomain(),this.$emit("update:settings",{...this.settings,privateData:{...this.settings.privateData,instanceId:m.getInstance()?.id,workspaceId:m.getWorkspace()?.id},publicData:{...this.settings.publicData,domain:m.getBaseDomain(),customDomain:m.getCustomDomain()||this.settings.publicData.customDomain}})},async changeApiKey(e){this.isLoading=!0,this.$emit("update:settings",{...this.settings,privateData:{...this.settings.privateData,apiKey:e}}),await m.changeApiKey(e),this.sync(),this.isLoading=!1},async changeMetaApiKey(e){this.$emit("update:settings",{...this.settings,privateData:{...this.settings.privateData,apiKey:null,metaApiKey:e}})},async changeInstance(e){this.isLoading=!0,await m.changeInstance(e),this.sync(),this.isLoading=!1},async changeWorkspace(e){this.isLoading=!0,await m.changeWorkspace(e),this.sync(),this.isLoading=!1},setCustomDomain(e){this.$emit("update:settings",{...this.settings,publicData:{...this.settings.publicData,customDomain:e}})}}},g=a(3744);const y=(0,g.Z)(h,[["render",u]]);var w=y}}]);